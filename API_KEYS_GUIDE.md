# üîë API Keys Guide

## üìã **Quick Reference**

### ‚úÖ **REQUIRED (Compulsory)**
These are needed for basic functionality:

| Key | Purpose | How to Get |
|-----|---------|------------|
| `JWT_SECRET` | Authentication tokens | Auto-generated by setup script |
| `DATABASE_URL` | PostgreSQL connection | Auto-configured for Docker |
| `REDIS_URL` | Cache connection | Auto-configured for Docker |

### ‚ö†Ô∏è **REQUIRED for Web3 Features**
These are needed if you want blockchain functionality:

| Key | Purpose | How to Get |
|-----|---------|------------|
| `SOLANA_RPC_URL` | Blockchain connection | Get from RPC provider |
| `WALLETCONNECT_PROJECT_ID` | Wallet connections | WalletConnect Cloud |

### üîß **OPTIONAL**
These enhance functionality but aren't required:

| Key | Purpose | How to Get |
|-----|---------|------------|
| `WALLET_PRIVATE_KEY` | Server wallet for minting | Generate with Solana CLI |
| `APPLE_WALLET_*` | iOS .pkpass files | Apple Developer Program |
| `EMAIL_SERVICE_API_KEY` | Email notifications | Email service provider |

---

## üöÄ **Minimum Setup (Basic Functionality)**

The project will run with just these (auto-configured):

```bash
# packages/backend/.env
JWT_SECRET="auto-generated-by-setup-script"
DATABASE_URL="postgresql://postgres:password@localhost:5432/queue_skip_web3"
REDIS_URL="redis://localhost:6379"
```

**What works:**
- ‚úÖ User login/registration
- ‚úÖ Pass allocation and management
- ‚úÖ Dynamic QR codes (30-second refresh)
- ‚úÖ Staff scanner validation
- ‚úÖ Pass transfers (database-only)
- ‚úÖ Admin dashboard
- ‚úÖ Real-time WebSocket updates

**What doesn't work:**
- ‚ùå Blockchain transparency (NFT minting/transfers)
- ‚ùå Web3 wallet authentication
- ‚ùå Blockchain transaction history

---

## üåê **Web3 Setup (Full Functionality)**

Add these for complete blockchain integration:

### 1. **Solana RPC URL** (Required for Web3)

**Free Options:**
```bash
# Devnet (for testing)
SOLANA_RPC_URL="https://api.devnet.solana.com"

# Mainnet (for production)
SOLANA_RPC_URL="https://api.mainnet-beta.solana.com"
```

**Paid Options (Better performance):**
- **QuickNode**: https://www.quicknode.com/
- **Alchemy**: https://www.alchemy.com/solana
- **Helius**: https://helius.xyz/

```bash
# Example with QuickNode
SOLANA_RPC_URL="https://your-endpoint.solana-devnet.quiknode.pro/your-key/"
```

### 2. **WalletConnect Project ID** (Required for Web3)

1. Go to https://cloud.walletconnect.com/
2. Sign up and create a new project
3. Copy the Project ID

```bash
WALLETCONNECT_PROJECT_ID="your-project-id-here"
```

### 3. **Wallet Private Key** (Optional but recommended)

Generate a Solana keypair for the server:

```bash
# Install Solana CLI
sh -c "$(curl -sSfL https://release.solana.com/v1.16.0/install)"

# Generate new keypair
solana-keygen new --outfile server-wallet.json

# Get the private key array
cat server-wallet.json
```

Copy the array format:
```bash
WALLET_PRIVATE_KEY="[123,45,67,...]"  # The full array from the file
```

---

## üçé **Apple Wallet Setup (Optional)**

For iOS .pkpass file generation:

### Prerequisites
- Apple Developer Program membership ($99/year)
- macOS for certificate generation

### Steps

1. **Join Apple Developer Program**
   - Go to https://developer.apple.com/programs/
   - Pay $99 annual fee

2. **Create Pass Type ID**
   - Login to Apple Developer Console
   - Go to "Certificates, Identifiers & Profiles"
   - Create new "Pass Type ID": `pass.com.yourcompany.queueskip`

3. **Generate Certificates**
   ```bash
   # Create certificate signing request
   openssl req -new -key private.key -out request.csr
   
   # Upload CSR to Apple Developer Console
   # Download the certificate
   ```

4. **Configure Environment**
   ```bash
   APPLE_WALLET_TEAM_ID="your-10-character-team-id"
   APPLE_WALLET_PASS_TYPE_ID="pass.com.yourcompany.queueskip"
   APPLE_WALLET_CERTIFICATE_PATH="/path/to/pass-certificate.p12"
   APPLE_WALLET_CERTIFICATE_PASSWORD="your-certificate-password"
   APPLE_WALLET_WWDR_CERTIFICATE_PATH="/path/to/wwdr-certificate.pem"
   ```

---

## üìß **Email Service Setup (Optional)**

For pass expiration reminders and notifications:

### Popular Options

**SendGrid:**
```bash
EMAIL_SERVICE_API_KEY="SG.your-sendgrid-api-key"
EMAIL_SERVICE_PROVIDER="sendgrid"
```

**Mailgun:**
```bash
EMAIL_SERVICE_API_KEY="your-mailgun-api-key"
EMAIL_SERVICE_PROVIDER="mailgun"
```

**AWS SES:**
```bash
EMAIL_SERVICE_API_KEY="your-aws-access-key"
EMAIL_SERVICE_SECRET="your-aws-secret-key"
EMAIL_SERVICE_PROVIDER="ses"
```

---

## üîß **Environment File Template**

Here's your complete `packages/backend/.env` file:

```bash
# ===== REQUIRED (Basic Functionality) =====
JWT_SECRET="your-jwt-secret-here"
DATABASE_URL="postgresql://postgres:password@localhost:5432/queue_skip_web3"
REDIS_URL="redis://localhost:6379"

# Server Configuration
PORT=3001
NODE_ENV="development"
CORS_ORIGIN="http://localhost:3000,http://localhost:3002,http://localhost:3003"

# ===== REQUIRED FOR WEB3 FEATURES =====
SOLANA_RPC_URL="https://api.devnet.solana.com"
SOLANA_NETWORK="devnet"
WALLETCONNECT_PROJECT_ID="your-walletconnect-project-id"

# ===== OPTIONAL =====
# Solana wallet for server operations
WALLET_PRIVATE_KEY="[1,2,3,...]"
SOLANA_PROGRAM_ID="your-deployed-program-id"

# Apple Wallet (for .pkpass files)
APPLE_WALLET_TEAM_ID=""
APPLE_WALLET_PASS_TYPE_ID=""
APPLE_WALLET_CERTIFICATE_PATH=""
APPLE_WALLET_CERTIFICATE_PASSWORD=""
APPLE_WALLET_WWDR_CERTIFICATE_PATH=""

# Email notifications
EMAIL_SERVICE_API_KEY=""
EMAIL_SERVICE_PROVIDER=""

# Push notifications
PUSH_NOTIFICATION_KEY=""

# Logging
LOG_LEVEL="info"
```

---

## üéØ **Recommended Setup Order**

### Phase 1: Basic Setup (5 minutes)
1. Run `./setup.sh` - This configures all required keys automatically
2. Test at http://localhost:3000

### Phase 2: Web3 Integration (15 minutes)
1. Get Solana RPC URL (free: use devnet, paid: QuickNode/Alchemy)
2. Get WalletConnect Project ID (free signup)
3. Add to `.env` and restart: `npm run dev`

### Phase 3: Enhanced Features (30+ minutes)
1. Generate Solana wallet keypair
2. Setup Apple Wallet certificates (if needed)
3. Configure email service (if needed)

---

## ‚ùó **Troubleshooting**

### "Blockchain service not available"
- Check `SOLANA_RPC_URL` is valid
- Test: `curl https://api.devnet.solana.com -X POST -H "Content-Type: application/json" -d '{"jsonrpc":"2.0","id":1,"method":"getHealth"}'`

### "WalletConnect connection failed"  
- Verify `WALLETCONNECT_PROJECT_ID` is correct
- Check project is active in WalletConnect Cloud

### "JWT secret not configured"
- Run setup script again: `./setup.sh`
- Or manually generate: `node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"`

---

## üí∞ **Cost Breakdown**

| Service | Cost | Purpose |
|---------|------|---------|
| **Basic Setup** | **FREE** | Core functionality |
| Solana Devnet | FREE | Testing blockchain features |
| Solana Mainnet | ~$0.00025/tx | Production blockchain |
| WalletConnect | FREE | Wallet connections |
| QuickNode/Alchemy | $9-49/month | Better RPC performance |
| Apple Developer | $99/year | iOS .pkpass files |
| Email Service | $0-20/month | Notifications |

**Recommendation:** Start with the free tier, upgrade as needed.
